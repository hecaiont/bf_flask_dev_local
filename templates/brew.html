<html>

<head>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <title>술친구</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    </head>
<body>
<div class="container"> 
<div class="page-header">
    
    <h1 class="display-5">
      <a href="http://술친구.온라인.한국">술친구.온라인.한국</a>
      <span class="pull-right">
          <a href="/" class="btn btn-default" role="button">
            <div class="hidden-xs" align="center">
                가양주 계산기 
            </div>
            <div class="visible-xs" align="center">
                ㄱㄱ
            </div>
          </a> 
      </span>
    </h1>
    </div>
    
</div>
<div class="container">
<div class="panel panel-default">
    <div class="panel-heading">쌀과 물의 양을 계산하고 결과물의 양을 계산</div>
    <div class="panel-heading"><small><span class="glyphicon glyphicon-plus gs"></span>를 눌러 작업을 추가, </small>
      <small><span class="glyphicon glyphicon-minus gs"></span>를 눌러 작업을 제거</small></div>
    <div class="panel-body">
    
    <form id="ingredient_filed" action = "http://localhost:5000/result" method = "POST">
      <!-- <button type="submit" class="btn btn-default" onclick="calculateRW()">계산</button><p class="text-center" id="expected">계산을 눌러주세요</p> -->
      <button type="submit" class="btn btn-default">계산</button>
      <p class="text-center" id="expected">계산을 눌러주세요</p>
    </form>

        <div class="btn-group btn-block">
          <button id="plusrowbtn" class="btn btn-success btn-block" type="button"  onclick="ingredient_filed();"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> </button>
        </div>
      </div>

    <!-- <div class="panel-footer">
      <button class="btn btn-default" onclick="calculateRW()">계산</button><p class="text-center" id="expected">계산을 눌러주세요</p>
    </div> -->

    </div>
    <div>
      {% if result != [''] %}
        <table class="table">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">쌀</th>
              <th scope="col">물</th>
              <th scope="col">누룩</th>
              <!-- <th scope="col">밀가루</th> -->
              <th scope="col">부재료</th>
              <th scope="col">기간</th>
            </tr>
          </thead>
          <tbody>
        {% for item in result %}
        <tr>
          {% if loop.index0 == 0 %}
          <th scope="row">밑술</th>
          {% else %}
          <th scope="row">덧술 #{{ loop.index0 }}</th>
          {% endif %}

            {% for i in item %}
            
              {% for k,v in i.items() %}
                {% if v == 0 %}
                <td class="col-sm-2"></td>
                {% else %}
                <td class="col-sm-2">{{ v }}</td>
                {% endif %}
              {% endfor %}      
            {% endfor %}
          </tr>
        {% endfor %}
        <thead>
          <tr>
            <th scope="col">합계</th>
            <th scope="col">{{ t_rice }}</th>
            <th scope="col">{{ t_water }}</th>
            <th scope="col">{{ t_yeast }}</th>
            <!-- <th scope="col">{{ t_flour }}</th> -->
            <th scope="col">{{ t_submaterials }}</th>
            <th scope="col">{{ t_interval }}</th>
          </tr>
        </thead>
      </tbody>
      </table>
      {% endif %}
    </div>



    


<script>
var room = 0;
function ingredient_filed() {
 
    room++;
    var objTo = document.getElementById('ingredient_filed')
    var divtest = document.createElement("div");
	divtest.setAttribute("class", "form-group removeclass"+room);
	var rdiv = 'removeclass'+room;
      // divtest.innerHTML = '<div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="rice" name="rice#'+room+'" value="" placeholder="쌀"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="water" name="water#'+room+'" value="" placeholder="물"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="yeast" name="yeast#'+room+'" value="" placeholder="누룩"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="flour" name="flour#'+room+'" value="" placeholder="밀가루"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="subMaterials" name="subMaterials#'+room+'" value="" placeholder="부재료"></div></div><div class="col-sm-2 nopadding"><div class="form-group"><div class="input-group"><input type="number" class="form-control" id="interval" name="interval#'+room+'" value="" placeholder="기간"><div class="input-group-btn"> <button class="btn btn-danger" type="button" onclick="remove_ingredient_filed('+ room +');"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span> </button></div></div></div></div><div class="clear"></div>';
      // divtest.innerHTML = '<div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="rice" name="rice#'+room+'" value="" placeholder="쌀"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="water" name="water#'+room+'" value="" placeholder="물"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="yeast" name="yeast#'+room+'" value="" placeholder="누룩"></div></div><div class="col-sm-2 nopadding"><div class="form-group"> <input type="number" class="form-control" id="subMaterials" name="subMaterials#'+room+'" value="" placeholder="부재료"></div></div><div class="col-sm-2 nopadding"><div class="form-group"><div class="input-group"><input type="number" class="form-control" id="interval" name="interval#'+room+'" value="" placeholder="기간"></div></div><div class="col-sm-2 nopadding"><div class="form-group"><div class="input-group-btn"> <button class="btn btn-danger" type="button" onclick="remove_ingredient_filed('+ room +');"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span> </button></div></div></div></div>';
      divtest.innerHTML = '<div class="col-sm-2"><div class="form-group"><input type="number" class="form-control" id="rice" name="rice#'+room+'" value="" placeholder="쌀"></div></div><div class="col-sm-2"><div class="form-group"><input type="number" class="form-control" id="water" name="water#'+room+'" value="" placeholder="물"></div></div><div class="col-sm-2"><div class="form-group"><input type="number" class="form-control" id="yeast" name="yeast#'+room+'" value="" placeholder="누룩"></div></div><div class="col-sm-2"><div class="form-group"><input type="number" class="form-control" id="subMaterials" name="subMaterials#'+room+'" value="" placeholder="부재료"></div></div><div class="col-sm-4"><div class="form-group"><div class="input-group"><input type="number" class="form-control" id="interval" name="interval#'+room+'" value="" placeholder="기간"><div class="input-group-btn"> <button class="btn btn-danger" type="button" onclick="remove_ingredient_filed('+ room +');"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span> </button></div></div></div></div><div class="clear"></div>'

    objTo.appendChild(divtest)
    check_room_number()
}

function remove_ingredient_filed(rid) {
  $('.removeclass'+rid).remove();
}

var btn = document.getElementById("plusrowbtn");

function check_room_number() {
    if(room > 20) {
        btn.style.display = "none";
    } else {
        btn.style.display = "block";
    } 
}

function calculateRW() {
  var totalRice = 0;
  var totalWater = 0;
  var totalYeast = 0;
  var totalFlour = 0;
  var totalSubMaterials = 0;
  var totalIntervals = 0;


  for (i = 0; i < room; i++) {
    totalRice += Number(document.getElementsByName("rice")[i].value);
    totalWater += Number(document.getElementsByName("water")[i].value);
    totalYeast += Number(document.getElementsByName("yeast")[i].value);
    totalFlour += Number(document.getElementsByName("flour")[i].value);
    totalSubMaterials += Number(document.getElementsByName("subMaterials")[i].value);
    totalIntervals += Number(document.getElementsByName("interval")[i].value);

  }
  document.getElementById("expected").innerHTML="전체 쌀 : " +totalRice+ ", 전체 물 : " +totalWater+", 전체 술 : " +Number(totalRice+totalWater)+ ", 쌀과 물의 비율 : " +(Number(totalRice/(totalRice+totalWater))*100).toFixed(1)+" 대 "+(Number(totalWater/(totalRice+totalWater))*100).toFixed(1)+", 전체 누룩 : "+totalYeast+", 전체 밀가루 : "+totalFlour+", 전체 부재료 : "+totalSubMaterials+", 총 기간 : "+totalIntervals;
}

</script>

</body>
<div class="footer navbar-fixed-bottom">
  <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0);">
    만든사람 : 
    <!-- <a href="mailto:dlsxo1518@gmail.com" title="dlsxo1518@gmail.com로 메일 보내기">dlsxo1518@gmail.com</a> -->
    <a href="https://www.instagram.com/i.t.cho/" class="text-decoration-none">
      @i.t.cho
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-instagram" viewBox="0 0 16 16">
    <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"></path>
    </svg>
    </a>
  </div>
</div>
</html>


